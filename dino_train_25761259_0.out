Launced with slurm
Launced with slurm
Launced with slurm
Launced with slurm
world size, rank, gpu, device count: 4 1 1 4
world size, rank, gpu, device count: 4 0 0 4
world size, rank, gpu, device count: 4 2 2 4
world size, rank, gpu, device count: 4 3 3 4
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
git:
  sha: 6a2b67ca2065c17da356d0ea4acc85f17f45164e, status: has uncommited changes, branch: master

arch: vit_base
batch_size_per_gpu: 100
clip_grad: 1.0
data_path: /scratch/eo41/data/saycam/SAY_5fps_300s_{000000..000009}.tar
dist_url: env://
epochs: 100
freeze_last_layer: 0
global_crops_scale: [0.2, 1.0]
gpu: 0
local_crops_number: 8
local_crops_scale: [0.05, 0.2]
local_rank: 0
lr: 0.0001
min_lr: 0.0001
momentum_teacher: 0.9995
norm_last_layer: True
num_workers: 8
optimizer: adamw
out_dim: 65536
output_dir: /scratch/eo41/dino/models_vitb14
patch_size: 14
print_freq: 5000
rank: 0
save_prefix: say_5fps_vitb14
saveckp_freq: 5000
seed: 1
teacher_temp: 0.04
use_bn_in_head: False
use_fp16: False
warmup_epochs: 0
warmup_teacher_temp: 0.04
warmup_teacher_temp_epochs: 0
weight_decay: 0.0
weight_decay_end: 0.0
world_size: 4
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:852: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:852: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:852: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torchvision/transforms/transforms.py:852: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  warnings.warn(
Data loaded.
Student and Teacher are built: they are both vit_base network.
Loss, optimizer and schedulers ready.
Found checkpoint at /scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth
=> loaded 'student' from checkpoint '/scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth' with msg <All keys matched successfully>
=> loaded 'teacher' from checkpoint '/scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth' with msg <All keys matched successfully>
=> loaded 'optimizer' from checkpoint: '/scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth'
=> key 'fp16_scaler' not found in checkpoint: '/scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth'
=> loaded 'dino_loss' from checkpoint '/scratch/eo41/dino/models_vitb14/say_5fps_vitb14_checkpoint.pth' with msg <All keys matched successfully>
Starting DINO training !
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bicubic is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3679: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bicubic is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bicubic is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3679: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3679: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bicubic is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
/scratch/eo41/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3679: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  warnings.warn(
Averaged stats: loss: 10.829580 (10.833444)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 10.919800 (11.003970)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 10.415532 (10.660730)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 9.880689 (10.138411)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 9.187640 (9.517734)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 7.615277 (8.471636)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 6.586984 (7.129776)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 5.766452 (6.151474)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 5.212986 (5.484679)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 4.875572 (5.008009)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 4.497568 (4.652600)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 4.200633 (4.391779)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 4.046765 (4.176959)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.958656 (3.994749)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.848271 (3.843392)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.589523 (3.718641)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.627779 (3.606097)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.461501 (3.518237)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.409068 (3.426075)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.283415 (3.353480)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.268158 (3.280134)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.166426 (3.224858)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.151536 (3.174760)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.134201 (3.124621)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.078241 (3.076018)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 3.008218 (3.033062)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 2.980308 (2.995402)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
Averaged stats: loss: 2.932736 (2.963098)  lr: 0.000100 (0.000100)  wd: 0.000000 (0.000000)
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 25761259.0 ON ga003 CANCELLED AT 2022-10-11T16:21:13 ***
slurmstepd: error: *** JOB 25761259 ON ga003 CANCELLED AT 2022-10-11T16:21:13 ***
